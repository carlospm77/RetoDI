<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- HEAD -->
<!-- Inserta el fragmento <head> -->
<head th:replace="~{fragments/head :: head}"></head>

<!-- Permite que el footer quede abajo incluso con poco contenido -->
<body class="d-flex flex-column min-vh-100">

	<!-- NAVBAR -->
	<!-- Inserta el fragment del menú de navegación -->
	<th:block th:replace="~{fragments/navbar :: navbar}"></th:block>

	<!-- CONTENIDO PRINCIPAL -->
	<main class="container mt-4 flex-grow-1">

		<!-- Título dinámico: cambia según si la review es nueva o se está editando -->
		<h2 th:text="${review.id == null ? 'Nueva Review' : 'Editar Review'}"></h2>

		<!-- Formulario enlazado al objeto 'review' -->
		<form th:action="@{/reviews}" th:object="${review}" method="post"
			class="mt-3">

			<!-- Campo oculto para el ID (necesario al editar) -->
			<input type="hidden" th:field="*{id}" />

			<!-- Campo: Descripción de la review -->
			<div class="mb-3">
				<label class="form-label">Descripción</label>
				<textarea th:field="*{descripcion}" class="form-control" required></textarea>
			</div>

			<!-- Campo: Valoración numérica entre 1 y 5 -->
			<div class="mb-3">
				<label class="form-label">Valoración (1-5)</label> <input
					type="number" min="1" max="5" th:field="*{valoracion}"
					class="form-control" required>
			</div>

			<div class="mb-3">
				<label class="form-label">Cliente</label>

				<!-- Si es nueva review → mostrar select -->
				<select th:if="${review.id == null}" th:field="*{cliente.id}"
					class="form-select">
					<option th:each="c : ${clientes}" th:value="${c.id}"
						th:text="${c.nombre}"></option>
				</select>

				<!-- Si es edición → mostrar solo el nombre, sin permitir cambiar -->
				<input th:if="${review.id != null}" type="text" class="form-control"
					th:value="${review.cliente.nombre}" readonly>
			</div>

			<!-- Botones de acción -->
			<button class="btn btn-success">Guardar</button>
			<a href="/reviews" class="btn btn-secondary">Cancelar</a>
		</form>
	</main>

	<!-- FOOTER -->
	<!-- Inserta el fragment del footer -->
	<th:block th:replace="~{fragments/footer :: footer}"></th:block>

	<!-- SCRIPTS -->
	<!-- Inserta el fragment de los scripts -->
	<th:block th:replace="~{fragments/scripts :: scripts}"></th:block>
</body>
</html>
